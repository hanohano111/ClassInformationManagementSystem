<t-navbar title="通知" left-arrow />
<view class="page notices page-with-navbar">
  <view class="notices__content">
    <!-- 管理员：创建通知按钮 -->
    <view class="notices__actions" wx:if="{{isAdmin}}">
      <t-button theme="primary" block bindtap="goToCreateNotice">
        发布通知
      </t-button>
    </view>

    <!-- 通知列表 -->
    <view class="notices__list" wx:if="{{noticeList.length > 0}}">
      <block wx:for="{{noticeList}}" wx:for-item="notice" wx:key="id">
        <view class="notice-wrapper">
          <view 
            class="notice-item {{currentIndex === index ? 'notice-item--swiped' : ''}} {{isTouching ? 'notice-item--touching' : ''}}" 
            bindtap="onNoticeTap" 
            bindtouchstart="onTouchStart"
            bindtouchmove="onTouchMove"
            bindtouchend="onTouchEnd"
            data-notice-id="{{notice.id}}" 
            data-index="{{index}}"
            style="transform: translateX({{notice.translateX || 0}}rpx)"
          >
            <view class="notice-header">
              <view class="notice-title">{{notice.title}}</view>
            </view>
            <view class="notice-content" wx:if="{{notice.contentPreview}}">
              <text>{{notice.contentPreview}}</text>
            </view>
            <view class="notice-footer">
              <text class="notice-time">{{notice.createdAtText}}</text>
              <view class="notice-arrow">
                <text class="arrow-icon">></text>
              </view>
            </view>
          </view>
          <view class="notice-item__actions" wx:if="{{isAdmin}}">
            <view 
              class="action-btn action-btn--delete" 
              catchtap="onDeleteNotice"
              data-notice-id="{{notice.id}}" 
              data-index="{{index}}"
            >
              <t-icon name="delete" size="40rpx" color="#fff" />
            </view>
          </view>
        </view>
      </block>
    </view>

    <!-- 空状态 -->
    <view class="notices__empty" wx:else>
      <t-empty description="暂无通知" />
    </view>
  </view>
</view>
