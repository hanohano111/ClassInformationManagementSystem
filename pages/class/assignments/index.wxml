<t-navbar title="作业" left-arrow />
<view class="page assignments page-with-navbar">
  <view class="assignments__content">
    <!-- 管理员：创建作业按钮 -->
    <view class="assignments__actions" wx:if="{{isAdmin}}">
      <t-button theme="primary" block bindtap="goToCreateAssignment">
        发布作业
      </t-button>
    </view>

    <!-- 作业列表 -->
    <view class="assignments__list" wx:if="{{assignmentList.length > 0}}">
      <block wx:for="{{assignmentList}}" wx:for-item="assignment" wx:key="id">
        <view class="assignment-wrapper">
          <view 
            class="assignment-item {{currentIndex === index ? 'assignment-item--swiped' : ''}} {{isTouching ? 'assignment-item--touching' : ''}}" 
            bindtap="onAssignmentTap" 
            bindtouchstart="onTouchStart"
            bindtouchmove="onTouchMove"
            bindtouchend="onTouchEnd"
            data-assignment-id="{{assignment.id}}" 
            data-index="{{index}}"
            style="transform: translateX({{assignment.translateX || 0}}rpx)"
          >
            <view class="assignment-item__content">
              <view class="assignment-item__title">{{assignment.title}}</view>
              <view class="assignment-item__deadline" wx:if="{{assignment.deadlineText}}">
                <text class="deadline-text">{{assignment.deadlineText}}</text>
              </view>
            </view>
        <view class="assignment-item__status">
              <text class="status-tag status-tag--submitted" wx:if="{{assignment.submitStatusText === '已提交'}}">已提交</text>
              <text class="status-tag status-tag--overdue" wx:if="{{assignment.submitStatusText === '迟交'}}">迟交</text>
              <text class="status-tag status-tag--pending" wx:if="{{assignment.submitStatusText === '未提交'}}">未提交</text>
            </view>
            <view class="assignment-item__arrow">
              <text class="arrow-icon">></text>
            </view>
          </view>
          <view class="assignment-item__actions" wx:if="{{isAdmin}}">
            <view 
              class="action-btn action-btn--delete" 
              catchtap="onDeleteAssignment"
              data-assignment-id="{{assignment.id}}" 
              data-index="{{index}}"
            >
              <t-icon name="delete" size="40rpx" color="#fff" />
            </view>
          </view>
        </view>
      </block>
    </view>

    <!-- 空状态 -->
    <view class="assignments__empty" wx:else>
      <t-empty description="暂无作业" />
    </view>
  </view>
</view>
